(this["webpackJsonpgoit-react-hw-07-phonebook"]=this["webpackJsonpgoit-react-hw-07-phonebook"]||[]).push([[0],{28:function(t,e,n){t.exports={container:"UserMenu_container__3A8Qx",avatar:"UserMenu_avatar__1QBwy",name:"UserMenu_name__3ginI"}},32:function(t,e,n){"use strict";n.d(e,"a",(function(){return m})),n.d(e,"c",(function(){return L})),n.d(e,"d",(function(){return k})),n.d(e,"b",(function(){return z}));var c,r,a,o=n(14),u=n.n(o),i=n(18),s=n(15),l=n.n(s),b=n(4),d=Object(b.b)("contacts/fetchContactRequest"),j=Object(b.b)("contacts/fetchContactSuccess"),f=Object(b.b)("contacts/fetchContactError"),O=Object(b.b)("contacts/addContactRequest"),h=Object(b.b)("contacts/addContactSuccess"),p=Object(b.b)("contacts/addContactError"),g=Object(b.b)("contacts/deleteContactRequest"),v=Object(b.b)("contacts/deleteContactSuccess"),x=Object(b.b)("contacts/deleteContactError"),k=Object(b.b)("contacts/filter"),m={fetchContact:function(){return function(){var t=Object(i.a)(u.a.mark((function t(e){var n,c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(d()),t.prev=1,t.next=4,l.a.get("/contacts");case 4:n=t.sent,c=n.data,e(j(c)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),e(f(t.t0));case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},addContact:function(t){var e=t.name,n=t.number;return function(t){var c={name:e,number:n};t(O()),l.a.post("/contacts",c).then((function(e){var n=e.data;return t(h(n))})).catch((function(e){return t(p(e))}))}},deleteContact:function(t){return function(e){e(g()),l.a.delete("/contacts/".concat(t)).then((function(){return e(v(t))})).catch((function(t){return e(x(t))}))}}},y=n(20),C=function(t){return t.contacts.filter},I=function(t){return t.contacts.items},L={getFilter:C,getAllContacts:I,getFilteredContacts:Object(y.a)([I,C],(function(t,e){var n=e.toLowerCase();return t.filter((function(t){return t.name.toLowerCase().includes(n)}))})),getError:function(t){return t.contacts.error}},w=n(2),U=n(26),_=n(8),A=Object(b.d)([],(c={},Object(w.a)(c,j,(function(t,e){return e.payload})),Object(w.a)(c,h,(function(t,e){var n=e.payload;return[].concat(Object(U.a)(t),[n])})),Object(w.a)(c,v,(function(t,e){var n=e.payload;return t.filter((function(t){return t.id!==n}))})),c)),F=Object(b.d)("",Object(w.a)({},k,(function(t,e){return e.payload}))),S=Object(b.d)(!1,(r={},Object(w.a)(r,d,(function(){return!0})),Object(w.a)(r,j,(function(){return!1})),Object(w.a)(r,f,(function(){return!1})),Object(w.a)(r,O,(function(){return!0})),Object(w.a)(r,h,(function(){return!1})),Object(w.a)(r,p,(function(){return!1})),Object(w.a)(r,g,(function(){return!0})),Object(w.a)(r,v,(function(){return!1})),Object(w.a)(r,x,(function(){return!1})),r)),E=Object(b.d)(null,(a={},Object(w.a)(a,d,(function(){return null})),Object(w.a)(a,f,(function(t,e){return e.payload.response.data})),Object(w.a)(a,O,(function(){return null})),Object(w.a)(a,p,(function(t,e){return e.payload.response.data})),Object(w.a)(a,g,(function(){return null})),Object(w.a)(a,x,(function(t,e){return e.payload.response.data})),a)),z=Object(_.b)({items:A,filter:F,loading:S,error:E})},42:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var c=n(45),r=n.n(c),a=n(1);function o(t){var e=t.children;return Object(a.jsx)("div",{className:r.a.container,children:e})}},44:function(t,e,n){t.exports={header:"AppBar_header__3Rc1d"}},45:function(t,e,n){t.exports={container:"Container_container__3WIcA"}},7:function(t,e,n){"use strict";n.d(e,"a",(function(){return f})),n.d(e,"c",(function(){return O})),n.d(e,"b",(function(){return p}));var c=n(14),r=n.n(c),a=n(18),o=n(15),u=n.n(o),i=n(4);u.a.defaults.baseURL="https://connections-api.herokuapp.com";var s,l=function(t){u.a.defaults.headers.common.Authorization="Bearer ".concat(t)},b=function(){u.a.defaults.headers.common.Authorization=""},d=Object(i.c)("auth/register",function(){var t=Object(a.a)(r.a.mark((function t(e){var n,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.a.post("/users/signup",e);case 3:return n=t.sent,c=n.data,l(c.token),t.abrupt("return",c);case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),j=Object(i.c)("auth/login",function(){var t=Object(a.a)(r.a.mark((function t(e){var n,c;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.a.post("/users/login",e);case 3:return n=t.sent,c=n.data,l(c.token),t.abrupt("return",c);case 9:t.prev=9,t.t0=t.catch(0);case 11:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),f={register:d,logOut:Object(i.c)("auth/logout",Object(a.a)(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.a.post("/users/logout");case 3:b(),t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])})))),logIn:j,fetchCurrentUser:Object(i.c)("auth/refresh",function(){var t=Object(a.a)(r.a.mark((function t(e,n){var c,a,o,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=n.getState(),null!==(a=c.auth.token)){t.next=4;break}return t.abrupt("return",n.rejectWithValue());case 4:return l(a),t.prev=5,t.next=8,u.a.get("/users/current");case 8:return o=t.sent,i=o.data,t.abrupt("return",i);case 13:t.prev=13,t.t0=t.catch(5);case 15:case"end":return t.stop()}}),t,null,[[5,13]])})));return function(e,n){return t.apply(this,arguments)}}())},O={getIsLoggedIn:function(t){return t.auth.isLoggedIn},getUserName:function(t){return t.auth.user.name},getIsFetchingCurrent:function(t){return t.auth.isFetchingCurrentUser}},h=n(2),p=Object(i.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1,isFetchingCurrentUser:!1},extraReducers:(s={},Object(h.a)(s,f.register.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(h.a)(s,f.logIn.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(h.a)(s,f.logOut.fulfilled,(function(t){t.user={name:null,email:null},t.token=null,t.isLoggedIn=!1})),Object(h.a)(s,f.fetchCurrentUser.pending,(function(t){t.isFetchingCurrentUser=!0})),Object(h.a)(s,f.fetchCurrentUser.fulfilled,(function(t,e){t.user=e.payload,t.isLoggedIn=!0,t.isFetchingCurrentUser=!1})),Object(h.a)(s,f.fetchCurrentUser.rejected,(function(t){t.isFetchingCurrentUser=!1})),s)}).reducer},80:function(t,e,n){"use strict";n.r(e);var c=n(0),r=n.n(c),a=n(24),o=n.n(a),u=n(16),i=n(6),s=n(5),l=n(7),b=n(1),d={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,color:"#2A363B"},activeLink:{color:"#E84A5F"}},j=function(){var t=Object(i.c)(l.c.getIsLoggedIn);return Object(b.jsxs)("nav",{children:[Object(b.jsx)(u.b,{to:"/",exact:!0,style:d.link,activeStyle:d.activeLink,children:"Home"}),t&&Object(b.jsx)(u.b,{to:"/contacts",exact:!0,style:d.link,activeStyle:d.activeLink,children:"Contacts"})]})},f=n.p+"static/media/default-avatar.e44fc4e2.png",O=n(28),h=n.n(O);function p(){var t=Object(i.b)(),e=Object(i.c)(l.c.getUserName),n=f;return Object(b.jsxs)("div",{className:h.a.container,children:[Object(b.jsx)("img",{src:n,alt:"",width:"32",className:h.a.avatar}),Object(b.jsxs)("span",{className:h.a.name,children:["Wellcome, ",e]}),Object(b.jsx)("button",{type:"button",onClick:function(){return t(l.a.logOut())},children:"\u0412\u044b\u0439\u0442\u0438"})]})}var g={link:{display:"inline-block",textDecoration:"none",padding:12,fontWeight:700,color:"#2A363B"},activeLink:{color:"#E84A5F"}};function v(){return Object(b.jsxs)("div",{children:[Object(b.jsx)(u.b,{to:"/register",exact:!0,style:g.link,activeStyle:g.activeLink,children:"Register"}),Object(b.jsx)(u.b,{to:"/login",exact:!0,style:g.link,activeStyle:g.activeLink,children:"Login"})]})}var x=n(44),k=n.n(x);function m(){var t=Object(i.c)(l.c.getIsLoggedIn);return Object(b.jsxs)("header",{className:k.a.header,children:[Object(b.jsx)(j,{}),t?Object(b.jsx)(p,{}):Object(b.jsx)(v,{})]})}var y=n(42),C=n(21),I=n(27),L=["children","redirectTo"];function w(t){var e=t.children,n=t.redirectTo,c=void 0===n?"/":n,r=Object(I.a)(t,L),a=Object(i.c)(l.c.getIsLoggedIn);return Object(b.jsx)(s.b,Object(C.a)(Object(C.a)({},r),{},{children:a?e:Object(b.jsx)(s.a,{to:c})}))}var U=["children","restricted","redirectTo"];function _(t){var e=t.children,n=t.restricted,c=void 0!==n&&n,r=t.redirectTo,a=void 0===r?"/":r,o=Object(I.a)(t,U),u=Object(i.c)(l.c.getIsLoggedIn)&&c;return Object(b.jsx)(s.b,Object(C.a)(Object(C.a)({},o),{},{children:u?Object(b.jsx)(s.a,{to:a}):e}))}var A=Object(c.lazy)((function(){return n.e(6).then(n.bind(null,86))})),F=Object(c.lazy)((function(){return n.e(5).then(n.bind(null,87))})),S=Object(c.lazy)((function(){return n.e(4).then(n.bind(null,88))})),E=Object(c.lazy)((function(){return n.e(3).then(n.bind(null,89))}));function z(){var t=Object(i.b)(),e=Object(i.c)(l.c.getIsFetchingCurrent);return Object(c.useEffect)((function(){t(l.a.fetchCurrentUser())}),[t]),!e&&Object(b.jsxs)(y.a,{children:[Object(b.jsx)(m,{}),Object(b.jsx)(s.d,{children:Object(b.jsxs)(c.Suspense,{fallback:Object(b.jsx)("p",{children:"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c..."}),children:[Object(b.jsx)(_,{exact:!0,path:"/",children:Object(b.jsx)(A,{})}),Object(b.jsx)(_,{exact:!0,path:"/register",restricted:!0,children:Object(b.jsx)(F,{})}),Object(b.jsx)(_,{exact:!0,path:"/login",redirectTo:"/contacts",restricted:!0,children:Object(b.jsx)(S,{})}),Object(b.jsx)(w,{path:"/contacts",redirectTo:"/login",children:Object(b.jsx)(E,{})})]})})]})}var N=n(26),R=n(4),T=n(17),B=n(46),W=n.n(B),M=n(32),q=Object(N.a)(Object(R.f)({serializableCheck:{ignoredActions:[T.a,T.f,T.b,T.c,T.d,T.e]}})),D={key:"auth",storage:W.a,whitelist:["token"]},J=Object(R.a)({reducer:{auth:Object(T.g)(D,l.b),contacts:M.b},middleware:q,devTools:!1}),Q=Object(T.h)(J),H=n(47);n(79);o.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(i.a,{store:J,children:Object(b.jsx)(H.a,{loading:null,persistor:Q,children:Object(b.jsx)(u.a,{children:Object(b.jsx)(z,{})})})})}),document.getElementById("root"))}},[[80,1,2]]]);
//# sourceMappingURL=main.fffe85dc.chunk.js.map